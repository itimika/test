# Flet Calculator App - Project Plan

## 機能一覧と優先度

### MVP (最小viable product)
- **基本四則演算**: +, -, ×, ÷
- **数字入力**: 0-9 ボタン
- **小数点入力**: . ボタン
- **計算実行**: = ボタン
- **クリア機能**: AC (All Clear), C (Clear)
- **バックスペース**: BS ボタン
- **符号反転**: ± ボタン
- **結果表示**: LCD風ディスプレイ
- **エラー処理**: ゼロ除算、オーバーフロー対応
- **Flet Web対応**: ブラウザで動作

### Nice to Have (将来拡張)
- **メモリ機能**: MC (Memory Clear), MR (Memory Recall), M+ (Memory Add), M- (Memory Subtract)
- **キーボード入力**: 数字キー、演算子キー対応
- **パーセント計算**: % ボタン
- **計算履歴**: 過去の計算結果表示
- **テーマ切替**: ライト/ダークモード
- **Desktop版対応**: Flet Desktop での動作
- **国際化**: 小数点・桁区切り記号の地域対応

## WBS (作業分解構造)

### 1. 環境構築・プロジェクト初期化
- [ ] 1.1 Python仮想環境作成
- [ ] 1.2 Flet依存関係インストール
- [ ] 1.3 プロジェクト構造作成
- [ ] 1.4 開発スクリプト作成 (Makefile, scripts/)

### 2. アーキテクチャ設計
- [ ] 2.1 UIコンポーネント設計
- [ ] 2.2 状態管理設計
- [ ] 2.3 計算ロジック設計
- [ ] 2.4 エラーハンドリング設計

### 3. 計算ロジック実装 (app/logic.py)
- [ ] 3.1 基本演算関数 (+, -, ×, ÷)
- [ ] 3.2 演算子優先順位処理
- [ ] 3.3 小数点・符号処理
- [ ] 3.4 エラー処理 (ゼロ除算等)
- [ ] 3.5 入力バリデーション

### 4. 状態管理実装 (app/state.py)
- [ ] 4.1 Calculator状態クラス
- [ ] 4.2 表示値管理
- [ ] 4.3 入力バッファ管理
- [ ] 4.4 演算子・結果管理

### 5. UI実装 (app/ui.py)
- [ ] 5.1 LCD風ディスプレイ
- [ ] 5.2 数字ボタングリッド (0-9)
- [ ] 5.3 演算子ボタン (+, -, ×, ÷, =)
- [ ] 5.4 機能ボタン (AC, C, BS, ±, .)
- [ ] 5.5 レスポンシブレイアウト

### 6. テスト実装 (tests/)
- [ ] 6.1 計算ロジック単体テスト
- [ ] 6.2 状態管理テスト
- [ ] 6.3 UI操作テスト (可能な範囲)
- [ ] 6.4 エラーケーステスト

### 7. 統合・動作確認
- [ ] 7.1 Web版動作確認
- [ ] 7.2 基本操作フロー確認 (1+2=3)
- [ ] 7.3 エラーケース動作確認
- [ ] 7.4 レスポンシブ動作確認

### 8. 拡張機能 (Nice to Have)
- [ ] 8.1 メモリ機能実装
- [ ] 8.2 キーボード入力対応
- [ ] 8.3 履歴機能
- [ ] 8.4 Desktop版対応

## 成功基準
- `make venv && make dev` でWebサーバ起動
- 基本計算 (1+2=3) が正常動作
- 全テストがパス (`pytest -q`)
- 主要UI操作が機能 (AC/C/BS/±/./%/÷×−＋/=)

## リスク
- Flet Web版の制約・バグ
- 浮動小数点演算の精度問題
- ブラウザ間での動作差異
- レスポンシブ対応の複雑さ